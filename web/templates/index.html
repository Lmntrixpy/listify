{% extends "layout.html" %}

{% block title %}Lieblingssongs → Playlist{% endblock %}

{% block content %}
  <section class="grid">
    <div class="card">
      <div class="card__header">
        <h2 class="h2">Account</h2>
      </div>

      {% if logged_in %}
        <div class="stack">
          <div>
            <div class="muted">Angemeldet als</div>
            <div class="strong">{{ me.display_name or me.id }}</div>
          </div>

          <form method="post" action="/logout">
            <button class="btn btn--ghost" type="submit">Logout</button>
          </form>
        </div>
      {% else %}
        <div class="stack">
          <p class="muted">Bitte mit Spotify anmelden, um eine Playlist zu erstellen.</p>
          <a class="btn btn--primary" href="/login">Mit Spotify anmelden</a>
        </div>
      {% endif %}
    </div>

    <div class="card">
      <div class="card__header">
        <h2 class="h2">Playlist erstellen</h2>
        <p class="muted">Wähle Quelle, Anzahl und erstelle eine Playlist in deinem Account.</p>
      </div>

      {% if not logged_in %}
        <p class="muted">Bitte zuerst einloggen.</p>
      {% else %}
        <div class="form">
          <div class="row">
            <div class="field">
              <label for="source">Quelle</label>
              <select id="source">
                <option value="liked" selected>Liked Songs</option>
                <option value="top">Top Tracks</option>
              </select>
              <div class="help">Liked Songs nutzt deine gespeicherten Titel, Top Tracks deine meistgehörten.</div>
            </div>

            <div class="field">
              <label for="time_range">Zeitraum</label>
              <select id="time_range">
                <option value="short_term">Letzte ~4 Wochen</option>
                <option value="medium_term">Letzte ~6 Monate</option>
                <option value="long_term">All Time</option>
              </select>
              <div class="help">Nur relevant für Top Tracks.</div>
            </div>

            <div class="field">
              <label for="limit">Anzahl</label>
              <div class="limitRow">
                <input id="limit" type="number" min="1" max="10000" value="50" inputmode="numeric" />
                <button id="allSongsBtn" class="btn btn--ghost btn--sm" type="button" title="Setzt das Limit auf 10.000">
                  Alle Lieder
                </button>
              </div>
              <div class="help">Max. 10.000 (Spotify Playlist-Limit). Wenn weniger vorhanden sind, werden nur die vorhandenen hinzugefügt.</div>
            </div>
          </div>

          <div class="row">
            <div class="field">
              <label for="name">Playlist-Name</label>
              <input id="name" type="text" value="Meine Lieblingssongs" maxlength="100" />
            </div>

            <div class="field">
              <label for="public">Sichtbarkeit</label>
              <select id="public">
                <option value="false" selected>Privat</option>
                <option value="true">Öffentlich</option>
              </select>
              <div class="help">Die Playlist muss öffentlich sein, damit sie für lunalist funktioniert.</div>
            </div>
          </div>

          <div class="field">
            <label for="description">Beschreibung</label>
            <input id="description" type="text" value="Automatisch erstellt aus meinen Lieblingssongs" maxlength="300" />
          </div>

          <div class="actions">
            <button id="createBtn" class="btn btn--primary" type="button">
              Playlist erstellen
            </button>
          </div>

          <pre class="status" id="status" aria-live="polite"></pre>
        </div>
      {% endif %}
    </div>
  </section>
{% endblock %}